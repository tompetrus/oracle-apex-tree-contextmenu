!function(a,b){a.widget("apex.treeView",a.apex.treeView,{setContextMenu:function(b){var d,c=this;if(c.contextMenu$)throw"a contextMenu has already been defined on this tree";if(b.contextMenu)if(a.apex.menu){if(b.contextMenu.menubar)throw"TreeView contextMenu must not be a menubar";b.contextMenu._originalBeforeOpen=b.contextMenu.beforeOpen,b.contextMenu.beforeOpen=function(a,d){b.contextMenu._originalBeforeOpen&&(d.menuElement=c.contextMenu$,d.tree=ctrl$,d.treeNodeAdapter=c.nodeAdapter,d.treeSelection=c.getSelection(),d.treeSelectedNodes=c.getNodes(d.treeSelection),b.contextMenu._originalBeforeOpen(a,d))},b.contextMenu.oldAfterClose=b.contextMenu.afterClose,b.contextMenu.afterClose=function(a,d){b.contextMenu.oldAfterClose&&(d.menuElement=c.contextMenu$,d.tree=ctrl$,b.contextMenu.oldAfterClose(a,d)),d.actionTookFocus||c.focus()},c.contextMenu$=a("<div style='display:none'></div>").appendTo("body"),b.contextMenuId&&(c.contextMenu$[0].id=b.contextMenuId),c.contextMenu$.menu(b.contextMenu),d&&debug.warn("TreeView contextMenuAction option ignored when contextMenu option present"),d=function(b){var d,e;"contextmenu"===b.type?c.contextMenu$.menu("toggle",b.pageX,b.pageY):(d=a(b.target),e=d.offset(),c.contextMenu$.menu("toggle",e.left,e.top+d.closest(SEL_CONTENT).height()))},c._setOption("contextMenuAction",d)}else debug.warn("TreeView contextMenu option ignored because menu widget not preset")}})}(apex.jQuery);